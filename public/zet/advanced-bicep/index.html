<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Notes: Advanced Bicep | Mischa van den Burg</title><meta name=keywords content="Zettelkasten,Bicep,Azure,Coding,Study"><meta name=description content="Deploying to subscriptions and management groups To tell Bicep which scope to deploy to, use the targetScope keyword, for example, managementGroup.
You&rsquo;re not specifying which management group exactly, this is done during deployment of the template file.
targetScope can be set to resourceGroup, subscription, managementGroup or tenant.
If it is not set, Bicep assumes resourceGroup.
create a resource group targetScope = 'subscription' resource resourceGroup 'Microsoft.Resources/resourceGroups@2021-01-01' = { name: 'example-resource-group' location: 'westus' } To deploy you use az deployment group create for resource groups, but you use az deployment sub create for subscriptions, mg for management group and tenant for tenant."><meta name=author content="Mischa van den Burg"><link rel=canonical href=https://mischavandenburg.com/zet/advanced-bicep/><link crossorigin=anonymous href=/assets/css/stylesheet.min.2985f2fa30372639adfab1e273fb6788b05b2b2a29c02604a3983ca3a92091e6.css integrity="sha256-KYXy+jA3Jjmt+rHic/tniLBbKyopwCYEo5g8o6kgkeY=" rel="preload stylesheet" as=style><link rel=icon href=https://mischavandenburg.com/favicon.ico><link rel=apple-touch-icon href=https://mischavandenburg.com/apple-touch-icon.png><script async src="https://www.googletagmanager.com/gtag/js?id=G-VLS3GJYW82"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VLS3GJYW82",{anonymize_ip:!1})}</script><meta name=twitter:card content="summary"><meta name=twitter:title content="Notes: Advanced Bicep | Mischa van den Burg"><meta name=twitter:description content="Deploying to subscriptions and management groups To tell Bicep which scope to deploy to, use the targetScope keyword, for example, managementGroup.
You&rsquo;re not specifying which management group exactly, this is done during deployment of the template file.
targetScope can be set to resourceGroup, subscription, managementGroup or tenant.
If it is not set, Bicep assumes resourceGroup.
create a resource group targetScope = 'subscription' resource resourceGroup 'Microsoft.Resources/resourceGroups@2021-01-01' = { name: 'example-resource-group' location: 'westus' } To deploy you use az deployment group create for resource groups, but you use az deployment sub create for subscriptions, mg for management group and tenant for tenant."><meta property="og:title" content="Notes: Advanced Bicep | Mischa van den Burg"><meta property="og:description" content="Deploying to subscriptions and management groups To tell Bicep which scope to deploy to, use the targetScope keyword, for example, managementGroup.
You&rsquo;re not specifying which management group exactly, this is done during deployment of the template file.
targetScope can be set to resourceGroup, subscription, managementGroup or tenant.
If it is not set, Bicep assumes resourceGroup.
create a resource group targetScope = 'subscription' resource resourceGroup 'Microsoft.Resources/resourceGroups@2021-01-01' = { name: 'example-resource-group' location: 'westus' } To deploy you use az deployment group create for resource groups, but you use az deployment sub create for subscriptions, mg for management group and tenant for tenant."><meta property="og:type" content="article"><meta property="og:url" content="https://mischavandenburg.com/zet/advanced-bicep/"><meta property="og:image" content="https://mischavandenburg.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="zet"><meta property="article:published_time" content="2023-03-18T00:00:00+00:00"><meta property="article:modified_time" content="2023-03-18T00:00:00+00:00"><meta property="og:site_name" content="Mischa's Blog & Zettelkasten"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Zettelkasten","item":"https://mischavandenburg.com/zet/"},{"@type":"ListItem","position":2,"name":"Notes: Advanced Bicep","item":"https://mischavandenburg.com/zet/advanced-bicep/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Notes: Advanced Bicep | Mischa van den Burg","name":"Notes: Advanced Bicep","description":"Deploying to subscriptions and management groups To tell Bicep which scope to deploy to, use the targetScope keyword, for example, managementGroup.\nYou\u0026rsquo;re not specifying which management group exactly, this is done during deployment of the template file.\ntargetScope can be set to resourceGroup, subscription, managementGroup or tenant.\nIf it is not set, Bicep assumes resourceGroup.\ncreate a resource group targetScope = \u0026#39;subscription\u0026#39; resource resourceGroup \u0026#39;Microsoft.Resources/resourceGroups@2021-01-01\u0026#39; = { name: \u0026#39;example-resource-group\u0026#39; location: \u0026#39;westus\u0026#39; } To deploy you use az deployment group create for resource groups, but you use az deployment sub create for subscriptions, mg for management group and tenant for tenant.","keywords":["Zettelkasten","Bicep","Azure","Coding","Study"],"wordCount":"498","inLanguage":"en","datePublished":"2023-03-18T00:00:00Z","dateModified":"2023-03-18T00:00:00Z","author":{"@type":"Person","name":"Mischa van den Burg"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://mischavandenburg.com/zet/advanced-bicep/"},"publisher":{"@type":"Organization","name":"Mischa van den Burg","logo":{"@type":"ImageObject","url":"https://mischavandenburg.com/favicon.ico"}}}</script><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary-bg:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list-page{background:var(--theme)}.list-page:not(.dark)::-webkit-scrollbar-track{background:0 0}.list-page:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript></head><body class="type-zet kind-page layout-" id=top><script data-no-instant>function switchTheme(e){switch(e){case"light":document.body.classList.remove("dark");break;case"dark":document.body.classList.add("dark");break;default:window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")}}function isDarkTheme(){return document.body.className.includes("dark")}function getPrefTheme(){return localStorage.getItem("pref-theme")}function setPrefTheme(e){switchTheme(e),localStorage.setItem("pref-theme",e)}const toggleThemeCallbacks={};toggleThemeCallbacks.main=e=>{setPrefTheme(e?"light":"dark")},window.addEventListener("toggle-theme",function(){const e=isDarkTheme();for(const t in toggleThemeCallbacks)toggleThemeCallbacks[t](e)});function toggleThemeListener(){window.dispatchEvent(new CustomEvent("toggle-theme"))}</script><script>(function(){const t="auto",e=getPrefTheme(),n=e||t;switchTheme(n)})()</script><header class=header><nav class=nav><div class=logo><a href=https://mischavandenburg.com/ accesskey=h title="Mischa van den Burg (Alt + H)">Mischa van den Burg</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://mischavandenburg.com/tags/ title=Tags>Tags</a></li><li><a href=https://mischavandenburg.com/zet/articles/ title=Articles>Articles</a></li><li><a href=https://mischavandenburg.com/aboutme/ title=About>About</a></li><li><a href=https://mischavandenburg.com/archives/ title=Archive>Archive</a></li><li><a href=https://mischavandenburg.com/zet/ title=Zettelkasten class=active>Zettelkasten</a></li></ul></nav></header><main class="main post"><article class=post-single><header class=post-header><h1 class=post-title>Notes: Advanced Bicep</h1><div class=post-meta><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar" style="user-select:text"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" style="user-select:text"/><line x1="16" y1="2" x2="16" y2="6" style="user-select:text"/><line x1="8" y1="2" x2="8" y2="6" style="user-select:text"/><line x1="3" y1="10" x2="21" y2="10" style="user-select:text"/></svg><span>March 18, 2023</span></span><span class=meta-item><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon" style="user-select:text"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z" style="user-select:text"/><line x1="7" y1="7" x2="7" y2="7" style="user-select:text"/></svg>
<span class=post-tags><a href=https://mischavandenburg.com/tags/zettelkasten/>Zettelkasten</a><a href=https://mischavandenburg.com/tags/bicep/>Bicep</a><a href=https://mischavandenburg.com/tags/azure/>Azure</a><a href=https://mischavandenburg.com/tags/coding/>Coding</a><a href=https://mischavandenburg.com/tags/study/>Study</a></span></span></div></header><div class=post-content><h1 id=deploying-to-subscriptions-and-management-groups>Deploying to subscriptions and management groups<a hidden class=anchor aria-hidden=true href=#deploying-to-subscriptions-and-management-groups>¶</a></h1><p>To tell Bicep which scope to deploy to, use the <code>targetScope</code> keyword, for example, managementGroup.</p><p>You&rsquo;re not specifying which management group exactly, this is done during deployment of the template file.</p><p>targetScope can be set to resourceGroup, subscription, managementGroup or tenant.</p><p>If it is not set, Bicep assumes resourceGroup.</p><h2 id=create-a-resource-group>create a resource group<a hidden class=anchor aria-hidden=true href=#create-a-resource-group>¶</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bicep data-lang=bicep><span class=line><span class=cl>targetScope<span class=w> </span><span class=p>=</span><span class=w> </span><span class=si>&#39;subscription&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>resource</span><span class=w> </span><span class=nf>resourceGroup</span><span class=w> </span><span class=s>&#39;Microsoft.Resources/resourceGroups@2021-01-01&#39;</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>name</span><span class=p>:</span><span class=w> </span><span class=s>&#39;example-resource-group&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>location</span><span class=p>:</span><span class=w> </span><span class=si>&#39;westus&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>To deploy you use <code>az deployment group create</code> for resource groups, but you use <code>az deployment sub create</code> for subscriptions, <code>mg</code> for management group and <code>tenant</code> for tenant.</p><h2 id=deployment-scripts>deployment scripts<a hidden class=anchor aria-hidden=true href=#deployment-scripts>¶</a></h2><blockquote><p>deploymentScripts resources are either PowerShell or Bash scripts that run in a Docker container as part of your template deployment. The default container images have either the Azure CLI or Azure PowerShell available. These scripts run during the processing of the ARM template, so you can add custom behavior to the deployment process.</p></blockquote><p>Here is an example of a deployment script with some comments:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bicep data-lang=bicep><span class=line><span class=cl><span class=kd>resource</span><span class=w> </span>myFirstDeploymentScript<span class=w> </span><span class=s>&#39;Microsoft.Resources/deploymentScripts@2020-10-01&#39;</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>name</span><span class=p>:</span><span class=w> </span><span class=si>&#39;myFirstDeploymentScript&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>location</span><span class=p>:</span><span class=w> </span><span class=nf>resourceGroup</span><span class=p>().</span>location<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c1>// can be AzurePowershell or Azure CLI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>kind</span><span class=p>:</span><span class=w> </span><span class=si>&#39;AzurePowerShell&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c1>// the script will be run in a container. We need to provide a Managed Identity to give the script the required permissions</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>identity</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=py>type</span><span class=p>:</span><span class=w> </span><span class=si>&#39;UserAssigned&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=py>userAssignedIdentities</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=s>&#39;/subscriptions/01234567-89AB-CDEF-0123-456789ABCDEF/resourcegroups/deploymenttest/providers/Microsoft.ManagedIdentity/userAssignedIdentities/myscriptingid&#39;</span><span class=p>:</span><span class=w> </span><span class=p>{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>properties</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=py>azPowerShellVersion</span><span class=p>:</span><span class=w> </span><span class=si>&#39;3.0&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// in Bicep we use &#39;&#39;&#39; to indicate a multi line string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=py>scriptContent</span><span class=p>:</span><span class=w> </span><span class=s>&#39;&#39;</span><span class=err>&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=err>$</span><span class=kd>output</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=s>&#39;Hello Learner!&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>Write-Output<span class=w> </span><span class=err>$</span><span class=kd>output</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=c1>// the $DeploymentScriptOutputs variable is created to return output back to the Bicep template</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=c1>// It needs to be a hash table</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=err>$</span>DeploymentScriptOutputs<span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>@{}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=err>$</span>DeploymentScriptOutputs<span class=p>[</span><span class=si>&#39;text&#39;</span><span class=p>]</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=err>$</span><span class=kd>output</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s>&#39;&#39;</span><span class=err>&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=py>retentionInterval</span><span class=p>:</span><span class=w> </span><span class=si>&#39;P1D&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>output</span><span class=w> </span>scriptResult<span class=w> </span><span class=nf>string</span><span class=w> </span><span class=p>=</span><span class=w> </span>myFirstDeploymentScript<span class=p>.</span>properties<span class=p>.</span>outputs<span class=p>.</span>text<span class=w>
</span></span></span></code></pre></div><blockquote><p>You can also write deployment scripts in Bash. To create outputs from a Bash script, you need to create a JSON file in a location specified by the AZ_SCRIPTS_OUTPUT_PATH environment variable.</p></blockquote><p>To include a script file, use the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bicep data-lang=bicep><span class=line><span class=cl><span class=py>properties</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>azPowerShellVersion</span><span class=p>:</span><span class=w> </span><span class=si>&#39;3.0&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>scriptContent</span><span class=p>:</span><span class=w> </span><span class=nf>loadTextContent</span><span class=p>(</span><span class=si>&#39;myscript.ps1&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>retentionInterval</span><span class=p>:</span><span class=w> </span><span class=si>&#39;P1D&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=deploying-a-managed-identity-and-assigning-a-role>deploying a managed identity and assigning a role<a hidden class=anchor aria-hidden=true href=#deploying-a-managed-identity-and-assigning-a-role>¶</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bicep data-lang=bicep><span class=line><span class=cl><span class=kd>var</span><span class=w> </span>userAssignedIdentityName<span class=w> </span><span class=p>=</span><span class=w> </span><span class=si>&#39;configDeployer&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>var</span><span class=w> </span>roleAssignmentName<span class=w> </span><span class=p>=</span><span class=w> </span><span class=nf>guid</span><span class=p>(</span><span class=nf>resourceGroup</span><span class=p>().</span>id<span class=err>,</span><span class=w> </span><span class=si>&#39;contributor&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>var</span><span class=w> </span>contributorRoleDefinitionId<span class=w> </span><span class=p>=</span><span class=w> </span><span class=nf>resourceId</span><span class=p>(</span><span class=s>&#39;Microsoft.Authorization/roleDefinitions&#39;</span><span class=err>,</span><span class=w> </span><span class=s>&#39;b24988ac-6180-42a0-ab88-20f7382dd24c&#39;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>resource</span><span class=w> </span>userAssignedIdentity<span class=w> </span><span class=s>&#39;Microsoft.ManagedIdentity/userAssignedIdentities@2018-11-30&#39;</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>name</span><span class=p>:</span><span class=w> </span>userAssignedIdentityName<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>location</span><span class=p>:</span><span class=w> </span><span class=nf>resourceGroup</span><span class=p>().</span>location<span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>resource</span><span class=w> </span>roleAssignment<span class=w> </span><span class=s>&#39;Microsoft.Authorization/roleAssignments@2020-04-01-preview&#39;</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>name</span><span class=p>:</span><span class=w> </span>roleAssignmentName<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>properties</span><span class=p>:</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=py>roleDefinitionId</span><span class=p>:</span><span class=w> </span>contributorRoleDefinitionId<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=py>principalId</span><span class=p>:</span><span class=w> </span>userAssignedIdentity<span class=p>.</span>properties<span class=p>.</span>principalId<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=py>principalType</span><span class=p>:</span><span class=w> </span><span class=si>&#39;ServicePrincipal&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=template-specs>template specs<a hidden class=anchor aria-hidden=true href=#template-specs>¶</a></h2><p>When you have a lot of reusable templates, you can use Template Specs to enable your entire organization to deploy them.</p><p>You can convert a Bicep file to a template spec. The template spec is then deployed to Azure as a resource, and anybody with the right access and do deployments with the template spec from the portal or Azure CLI. Azure will handle the version control.</p><p>You will lose any comments and whitespace.</p><p>Bicep modules are intended to be combined into larger deployments. Template specs are for sets of resources with a certain configuration.</p><p>Template specs can be used as a Bicep module. You use the following code to import it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bicep data-lang=bicep><span class=line><span class=cl><span class=kd>module</span><span class=w> </span>storageAccountTemplateSpec<span class=w> </span><span class=py>&#39;ts</span><span class=p>:</span>f0750bbe-ea75-4ae5-b24d-a92ca601da2c<span class=o>/</span>sharedTemplates<span class=o>/</span><span class=py>StorageWithoutSAS</span><span class=p>:</span>1<span class=p>.</span>0<span class=err>&#39;</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=py>name</span><span class=p>:</span><span class=w> </span><span class=si>&#39;storageAccountTemplateSpec&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div></div><footer class=post-footer><nav class=paginav><a class=next href=https://mischavandenburg.com/zet/docker-kubernetes-on-mac-m2/><span class=title>Next Page&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right" style="user-select:text"><line x1="5" y1="12" x2="19" y2="12" style="user-select:text"/><polyline points="12 5 19 12 12 19" style="user-select:text"/></svg></span><br><span>Running Docker and Kubernetes on Mac M2</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://mischavandenburg.com/>Mischa van den Burg</a></span><span style=display:inline-block;margin-left:1em>
<a href=https://creativecommons.org/licenses/by-nc-nd/4.0/>CC BY-NC-ND</a></span>
<span style=display:inline-block;margin-left:1em></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>(function(){const t=""=="1";if(t)return;let e=document.getElementById("theme-toggle");e.removeEventListener("click",toggleThemeListener),e.addEventListener("click",toggleThemeListener)})()</script><script>(function(){let e=document.getElementById("menu");e&&(e.scrollLeft=localStorage.getItem("menu-scroll-position"),e.onscroll=function(){localStorage.setItem("menu-scroll-position",e.scrollLeft)});const t=""=="1",n=""=="1";if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||t||n)return;document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})})()</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>if(window.scrollListeners)for(const e of scrollListeners)window.removeEventListener("scroll",e);window.scrollListeners=[]</script><script src=/js/medium-zoom.min.js data-no-instant></script>
<script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){const a=""=="1";if(!a)return;if(!document.querySelector(".toc")){console.log("no toc found, ignore toc scroll");return}const r=window.scrollListeners,t=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id]"),n="active";let e=t[0];o(e).classList.add(n);const c=()=>{const s=[];for(const e of t)if(l(e)<5)s.push(e);else break;s.length>0?newActiveHeading=s[s.length-1]:newActiveHeading=t[0],e!=newActiveHeading&&(o(e).classList.remove(n),e=newActiveHeading,o(e).classList.add(n))};let s=null;const i=()=>{s!==null&&clearTimeout(s),s=setTimeout(c,50)};window.addEventListener("scroll",i,!1),r.push(i);function o(e){const t=encodeURI(e.getAttribute("id")).toLowerCase();return document.querySelector(`.toc ul li a[href="#${t}"]`)}function l(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect();return t.top}})()</script></body></html>